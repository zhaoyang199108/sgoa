package com.bcqsoft.sgoa.common.util;

import com.jacob.activeX.ActiveXComponent;
import com.jacob.com.Dispatch;

/**
 * 指纹比对工具类
 * 
 * @author zbq
 * @date 2010-01-28
 */
public class MathFingerUtil {
	
	/**
	 * 指纹比对
	 * 
	 * @author ly
	 * @date 2010-01-28
	 * @param regFingertpl
	 *            数据库中指纹
	 * @param verFingertpl
	 *            输入的指纹
	 * @throws NativeException
	 * @throws IllegalAccessException
	 */
	public ActiveXComponent zhuChe() {
		ActiveXComponent ac = new ActiveXComponent(
				"clsid:35515A76-3049-4D2A-8457-FD83173037E9");
		return ac;
	}

	/**
	 * 指纹比对
	 * 
	 * @author ly
	 * @date 2010-01-28
	 * @param regFingertpl
	 *            数据库中指纹
	 * @param verFingertpl
	 *            输入的指纹
	 * @throws NativeException
	 * @throws IllegalAccessException
	 */
	public int verFinger(ActiveXComponent ac, String regFingertpl, String verFingertpl,
			String verFingertpl2, String verFingertpl3) {

		Dispatch sControl = (Dispatch) ac.getObject();
		// 目标指纹与原指纹1比对
		int res1 = Dispatch.call(sControl, "ZAZMatch", regFingertpl,
				verFingertpl).getInt();
		// 目标指纹与原指纹2比对
		int res2 = Dispatch.call(sControl, "ZAZMatch", regFingertpl,
				verFingertpl2).getInt();
		// 目标指纹与原指纹3比对
		int res3 = Dispatch.call(sControl, "ZAZMatch", regFingertpl,
				verFingertpl3).getInt();
		// 取得比对结果的最大值，作为比对结果
		if (res1 < res2) {
			res1 = res2;
		}
		if (res1 < res3) {
			res1 = res3;
		}
		sControl = null;
		ac = null;
		return res1;
	}

	/**
	 * 测试主方法
	 * 
	 * @param args
	 * @throws IllegalAccessException
	 * @throws NativeException
	 */
	public static void main(String[] args) {
		// TODO Auto-generated method stub
		MathFingerUtil math = new MathFingerUtil();
		String s1 = "030257180000FFFFFFFFE0FFC03FC01FC00FC00F800780078007800780078007800780078007800FC00FFFFF3074000000000000000000002C912C7E4794C3FE2A96D51E559B1A7E189D921E52A205DE20B229FE49B5093E263E26FE413FDF3E268DD43F2A1DABFF1A24511F162D27FF573E09DF51450A972DB990DD30C20DDD1794AABB2FB444381F15D3562097AB17323D8AD72EBE0E340000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000";
		String s2 = "030250200000FFFFE00FC00FC00780078003800380038003800380018001800180018001800180038003FFFF3C54207C00000000000000003F0814FE538CC29E661404BE3317EBFE649CC65E1220E73E15B58BFE68B5CB3E703B0B3E590681571610E9BF219651DF221B907F4022C4DF502386BF1F26A6BF48B28C1F2033247F3A348E5F3CBA0EBF363FE5BF29C0E71F32C5E81F0C3264DC3E3FD01D0C2E24BA12AE8DDA46C1907A4144661B21B8E55516C203351D3A22D0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000";
		String s3 = "030251220000FFFFFFFFFFFFF81FE00FC007C00380038003800180018001800180018001800180018001FFFF4068000000000000000000004712953E5B97829E3A22EB5E6B27867E0C37A4DE0C3CE47E6E410AFE1D9AA9FF282051DF29A550FF18A9277F452D44BF562E86BF2530671F1636CD9F20390D1F24BDA4BF3A44E4DD0E2FA5134737CB9B4DB94B3B0C32249251BDCD923CBA4E3932C465594DC60CB337364EF63C33CF973AB7A4B140BD0DD75040225148448D973FB40F942144235400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000";
		String s4 = "03024F200000FFFFFFFFF83FE01FC00FC007800780038003800380038003800380038003800380038003FFFF385820840000000000000000400A951E661EC69E161369DF219891BF339B6B5F231D507F11A2273F41A4C4FF512586BF20A7E6FF49B48BFF67378AFF134506570C2BE4DC1C310CDD20B5249D35B54E9D0E35A3BD453B0DDD0C3064DA122F0D9B3AB74E9B40388DFB15B74B9819B762D91BC3A0763741A5B71FC569973A2F4DD424BB25541A3CC9151FBCA2F1000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000";
//		int ss = math.verFinger(s1, s2, s3, s4);
//		System.out.print(ss);
	}
}
